{"cells":[{"cell_type":"code","metadata":{},"source":"%%configure -n project.spark.compatibility\n{\n    \"number_of_workers\": 10,\n    \"session_type\": \"etl\",\n    \"glue_version\": \"5.0\",\n    \"worker_type\": \"G.1X\",\n    \"idle_timeout\": 5,\n    \"timeout\": 60,\n    \"--enable-glue-datacatalog\": \"true\",\n    \"--enable-auto-scaling\": \"true\",\n    \"--project_s3_path\": \"s3://amazon-sagemaker-841815105446-us-east-2-8d69110117c2/dzd_d4jvhfifm74a5l/4uh5o13tjcakvd/dev\",\n    \"--redshift_iam_role\": \"arn:aws:iam::841815105446:role/datazone_usr_role_4uh5o13tjcakvd_4n5bxpjsnwdcmh\",\n    \"--redshift_tempdir\": \"s3://amazon-sagemaker-841815105446-us-east-2-8d69110117c2/dzd_d4jvhfifm74a5l/4uh5o13tjcakvd/dev/redshift-tmp/\",\n    \"--enable-lakeformation-fine-grained-access\": \"false\",\n    \"--datalake-formats\": \"iceberg\"\n}","execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{},"source":"%%pyspark project.spark.compatibility\nimport sys\nfrom pyspark.context import SparkContext\nfrom pyspark.sql import SparkSession\n\nimport json\nimport boto3\nimport gzip\nimport io\nimport os\nimport pyarrow.parquet as pq\nimport pyarrow.fs as pafs\nimport logging\nfrom typing import Optional\nimport random\nimport builtins\nimport csv\nfrom urllib.parse import urlparse\nfrom awsglue.utils import getResolvedOptions\nfrom pyspark.sql.functions import *\nfrom awsglue.context import GlueContext\nfrom awsglue.job import Job\nfrom pyspark.sql import SparkSession\nfrom py4j.protocol import Py4JJavaError","execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{},"source":"%%pyspark project.spark.compatibility\nsc = SparkContext.getOrCreate()\nspark = SparkSession.builder.getOrCreate()\n","execution_count":0,"outputs":[]}],"metadata":{"kernelspec":{"display_name":"Python 3 (ipykernel)","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.10.14"},"maxdomeModel":{"nodes":[],"edges":[],"direction":"horizontal","engine":"Glue","viewport":{"x":0,"y":0,"zoom":1},"interactiveSessionModel":{"additionalPythonModules":"","connections":[],"extraJars":[],"glueVersion":"5.0","extraPyFiles":[],"iamRole":"","numberOfWorkers":10,"sessionType":"etl","tags":{},"workerType":"G.1X","command":{"name":"glueetl","pythonVersion":"3"},"timeout":60,"idleTimeout":15},"name":"","version":"1.0.0","schemasMap":[],"datasamplesMap":[],"statementsMap":[],"createSessionRequest":{"Role":"arn:aws:iam::213679840349:role/datazone_usr_role_b3v8qpoirxcf1j_5kw6vz38pwwqsn","Connections":{"Connections":["datazone-glue-network-connection-4uh5o13tjcakvd-dev"]},"Command":{"Name":"glueetl","PythonVersion":"3"},"DefaultArguments":{"--enable-glue-datacatalog":"true","--enable-auto-scaling":"true","--project_s3_path":"s3://amazon-sagemaker-841815105446-us-east-2-8d69110117c2/dzd_d4jvhfifm74a5l/4uh5o13tjcakvd/dev","--redshift_iam_role":"arn:aws:iam::841815105446:role/datazone_usr_role_4uh5o13tjcakvd_4n5bxpjsnwdcmh","--redshift_tempdir":"s3://amazon-sagemaker-841815105446-us-east-2-8d69110117c2/dzd_d4jvhfifm74a5l/4uh5o13tjcakvd/dev/redshift-tmp/","--enable-lakeformation-fine-grained-access":"false","--datalake-formats":"iceberg","--conf":"spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions --conf spark.datasource.redshift.community.glue_endpoint=https://glue.us-east-2.amazonaws.com --conf spark.datasource.redshift.community.data_api_endpoint=https://redshift-data.us-east-2.amazonaws.com --conf spark.hadoop.fs.s3.impl=com.amazon.ws.emr.hadoop.fs.EmrFileSystem --conf spark.sql.catalog.spark_catalog=org.apache.iceberg.spark.SparkSessionCatalog --conf spark.sql.catalog.spark_catalog.catalog-impl=org.apache.iceberg.aws.glue.GlueCatalog --conf spark.sql.catalog.spark_catalog.glue.id=841815105446 --conf spark.sql.catalog.spark_catalog.glue.account-id=841815105446 --conf spark.sql.catalog.spark_catalog.glue.endpoint=https://glue.us-east-2.amazonaws.com --conf spark.sql.catalog.spark_catalog.client.region=us-east-2"},"GlueVersion":"5.0","RequestOrigin":"SageMakerUnifiedStudio_VisualETLDataPreview","Timeout":60,"IdleTimeout":15,"NumberOfWorkers":10,"WorkerType":"G.1X","Tags":{"AmazonDataZoneEnvironment":"5kw6vz38pwwqsn","AmazonDataZoneProject":"b3v8qpoirxcf1j","AmazonDataZoneDomain":"dzd_biurx0z60glbhj"}},"createSessionAdhocRequest":{"DefaultArguments":{"--enable-glue-datacatalog":"true","--enable-auto-scaling":"true","--project_s3_path":"s3://amazon-sagemaker-841815105446-us-east-2-8d69110117c2/dzd_d4jvhfifm74a5l/4uh5o13tjcakvd/dev","--redshift_iam_role":"arn:aws:iam::841815105446:role/datazone_usr_role_4uh5o13tjcakvd_4n5bxpjsnwdcmh","--redshift_tempdir":"s3://amazon-sagemaker-841815105446-us-east-2-8d69110117c2/dzd_d4jvhfifm74a5l/4uh5o13tjcakvd/dev/redshift-tmp/","--enable-lakeformation-fine-grained-access":"false","--datalake-formats":"iceberg","--conf":"spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions --conf spark.datasource.redshift.community.glue_endpoint=https://glue.us-east-2.amazonaws.com --conf spark.datasource.redshift.community.data_api_endpoint=https://redshift-data.us-east-2.amazonaws.com --conf spark.hadoop.fs.s3.impl=com.amazon.ws.emr.hadoop.fs.EmrFileSystem --conf spark.sql.catalog.spark_catalog=org.apache.iceberg.spark.SparkSessionCatalog --conf spark.sql.catalog.spark_catalog.catalog-impl=org.apache.iceberg.aws.glue.GlueCatalog --conf spark.sql.catalog.spark_catalog.glue.id=841815105446 --conf spark.sql.catalog.spark_catalog.glue.account-id=841815105446 --conf spark.sql.catalog.spark_catalog.glue.endpoint=https://glue.us-east-2.amazonaws.com --conf spark.sql.catalog.spark_catalog.client.region=us-east-2 --conf spark.datasource.redshift.community.glue_endpoint=https://glue.us-east-1.amazonaws.com --conf spark.datasource.redshift.community.data_api_endpoint=https://redshift-data.us-east-1.amazonaws.com --conf spark.driver.maxResultSize=0 --conf spark.sql.catalog.spark_catalog.glue.id=213679840349 --conf spark.sql.catalog.spark_catalog.glue.account-id=213679840349 --conf spark.sql.catalog.spark_catalog.glue.endpoint=https://glue.us-east-1.amazonaws.com --conf spark.sql.catalog.spark_catalog.client.region=us-east-1"}},"dpSettings":{"autoRestart":true,"sampleSize":100,"sampleColSize":100},"computeConnection":{"configurations":[{"classification":"GlueDefaultArgument","properties":{"--enable-lakeformation-fine-grained-access":"false"}}],"domainIdentifier":"dzd_biurx0z60glbhj","projectIdentifier":"b3v8qpoirxcf1j","environmentIdentifier":"5kw6vz38pwwqsn","connectionIdentifier":"5fj4k0mjlgp4br","name":"project.spark.compatibility","type":"SPARK","authorizationMode":"PROJECT","provisioningType":"MANAGED","location":{"awsRegion":"us-east-1","awsAccountId":"213679840349"},"physicalEndpoints":[{"awsLocation":{"awsAccountId":"213679840349","awsRegion":"us-east-1"},"glueConnectionName":"datazone-glue-network-connection-b3v8qpoirxcf1j-dev"}],"sparkGlueProperties":{"glueConnection":{},"sessionConfigs":{"idle_timeout":60,"glue_version":"5.0","worker_type":"G.1X","number_of_workers":10}}},"isSaved":true,"glueJobArn":"arn:aws:glue:us-east-1:213679840349:job/employee_vetl_script_2","dagOverrideFlags":[]}},"nbformat":4,"nbformat_minor":5}